飞思卡尔全国大学生智能车竞赛 直立节能组

# 项目日志

## 6.24

1. 测定陀螺仪和加速度计bias和比例

2. 调通了卡尔曼滤波

3. 测定小车过轴线时的倾斜角，设定其为平衡角，23.8°

4. pd参数调节，最终角度确定为23.87°，角度环参数P=2000 D=50

## 6.25, 6.26

1. 调了下电磁，实现基础的转向

2. 控速有点迷，一直没找到bug，进展不大

## 6.27

1. 找到控速bug, 因为限幅使得控速的角度附加全部处于死区，调节不过来

其他可能导致bug的原因：

- P太大

- 角度梯度太小

- angle_bias太小

- 限幅值太小

- 设定速度太大

## 6.28

1. 找到了疯狂振动(拖拉机)的原因, 角度环的D太大, 从59改到13后没有问题

## 6.29

1. 调通了左圆环，步骤如下:

    - 判断是左圆环or右圆环

    - 判断前瞻到切点

    - 判断车轮到切点，并将控制权移交竖电感

    - 用陀螺仪判断转向转过90度，此时将控制权移交横电感

    - 自然出环，待添加出环时屏蔽圆环状态的代码

2. 右环电感归一系数待调

    - 可考虑加偏置而不是单纯归一化

    - 考虑将1中的第二第三两个判断条件直接去掉（或许加上这两个条件实际意义不大）

## 7.5

1. 完成了速度的部分提升

    - 重新分割转向pd，加大d的作用

    - 加入抱死安全措施

## 7.6

1. 在高速下进圆环初步实现，问题比较大

2. 控速换成了PI控速，控速较稳

3. 小弯转向飘逸待改进？

## 7.7

1. 初步实现圆环进入，具体方法为通过补偿在圆环切点电感值减小的特点，产生交汇移交控制权给竖电感完成进环

2. 加入出环屏蔽，但圆环出环形成循环，出环时漂移，需要解决

3. 圆环入环准确率还不高，考虑角度补偿

4. 通过减小圆环中的偏差值圆滑圆环的过弯，圆环中莫名其妙抱死？

5. 可调节的有判断圆环的条件，入环的延迟距离，竖电感的归一化值，竖电感转向的pd

## 7.8

1. 完成入环2.0版本，出环1.0版本

    - 入环通过差值先减小后增大的现象设定阈值，完成入环的判断。

    - 出环通过减小出环时的deviation，同时增大d以补偿减小的deviation。

## 7.9 

1. 中断时间从1.25ms改为1.5ms

## 7.10

1. 通过限制angle_bias完成了过坡

2. 判坡用了个临时条件，最终决定加中间电感

